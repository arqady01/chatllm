# 键盘类型修复：支持负号输入

## 🐛 问题发现

### 原始问题
用户无法输入-1来表示无限制上下文，因为iOS的`keyboardType="numeric"`键盘不包含负号。

### 键盘类型对比

#### `keyboardType="numeric"`
```
┌─────┬─────┬─────┐
│  1  │  2  │  3  │
├─────┼─────┼─────┤
│  4  │  5  │  6  │
├─────┼─────┼─────┤
│  7  │  8  │  9  │
├─────┼─────┼─────┤
│  .  │  0  │ ⌫  │
└─────┴─────┴─────┘
```
**问题：没有负号(-)**

#### `keyboardType="numbers-and-punctuation"`
```
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐
│  1  │  2  │  3  │  4  │  5  │  6  │  7  │  8  │  9  │  0  │
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤
│  -  │  /  │  :  │  ;  │  (  │  )  │  $  │  &  │  @  │  "  │
├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤
│ 123 │  .  │  ,  │  ?  │  !  │  '  │     │     │     │ ⌫  │
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```
**优势：包含负号(-)**

## 🔧 解决方案

### 键盘类型修改
```typescript
// 修改前
keyboardType="numeric"

// 修改后
keyboardType="numbers-and-punctuation"
```

### 为什么选择这个键盘类型
1. **包含负号**：用户可以输入-1
2. **数字优先**：第一行全是数字，输入方便
3. **符号可用**：包含常用的数字相关符号
4. **iOS兼容**：在iOS上表现良好

## ✅ 修复效果

### 现在用户可以输入
- ✅ **-1**：无限制上下文
- ✅ **0**：无上下文
- ✅ **1, 2, 3, 10**：具体条数

### 输入体验改进
- **负号可用**：第二行左侧就是负号
- **数字便利**：第一行全是数字
- **输入流畅**：无需切换键盘

## 🎯 键盘类型选择指南

### React Native键盘类型对比

#### `numeric`
- **优点**：纯数字，界面简洁
- **缺点**：无负号，无小数点（某些平台）
- **适用**：只需要正整数的场景

#### `numbers-and-punctuation`
- **优点**：包含负号和常用符号
- **缺点**：键盘稍大，有多余符号
- **适用**：需要负数或符号的场景

#### `decimal-pad`
- **优点**：包含小数点
- **缺点**：无负号
- **适用**：需要小数的场景

#### `phone-pad`
- **优点**：包含+号和*号
- **缺点**：无负号，有电话相关符号
- **适用**：电话号码输入

### 我们的选择理由
```typescript
keyboardType="numbers-and-punctuation"
```

**原因：**
1. **功能需求**：必须支持-1输入
2. **用户体验**：数字在第一行，输入方便
3. **兼容性**：iOS和Android都支持
4. **安全性**：配合严格的输入验证

## 🔍 输入验证配合

### 键盘类型 + 验证规则
虽然键盘包含多种符号，但我们通过严格的验证确保安全：

```typescript
// 严格的正则验证
if (!/^-?\d+$/.test(trimmedInput)) {
  Alert.alert('错误', '只能输入整数，-1表示无限制，0或正整数表示具体条数');
  return;
}
```

### 多层防护
1. **键盘类型**：引导用户输入数字和符号
2. **正则验证**：确保格式正确
3. **业务验证**：确保数值有效
4. **错误提示**：指导用户正确输入

## 📱 平台兼容性

### iOS表现
- **键盘布局**：数字在上方，符号在下方
- **负号位置**：第二行左侧
- **用户习惯**：符合iOS用户预期

### Android表现
- **键盘布局**：可能略有不同，但功能一致
- **负号可用**：同样可以输入负号
- **兼容性**：React Native确保跨平台一致性

## 🚀 实际使用效果

### 用户操作流程
1. **点击输入框**：弹出数字和符号键盘
2. **输入-1**：点击负号，然后点击1
3. **输入正数**：直接点击数字
4. **保存验证**：系统验证输入格式

### 常用输入示例
- **-1** → 点击"-"然后"1"
- **0** → 直接点击"0"
- **10** → 点击"1"然后"0"
- **25** → 点击"2"然后"5"

## 🎯 最佳实践

### 键盘类型选择原则
1. **功能优先**：选择能满足所有输入需求的类型
2. **用户体验**：考虑用户的输入习惯
3. **安全验证**：配合严格的输入验证
4. **平台兼容**：确保跨平台一致性

### 输入组件设计
```typescript
<TextInput
  keyboardType="numbers-and-punctuation"  // 支持负号
  placeholder="输入整数（-1表示无限制）"    // 清晰提示
  autoCapitalize="none"                   // 禁用自动大写
  autoCorrect={false}                     // 禁用自动纠错
/>
```

这个修复确保了用户可以正常输入-1来表示无限制上下文，同时保持了良好的用户体验！📱
