# ä¼˜åŒ–åçš„æ»‘å—æ‰‹åŠ¿å¤„ç†

## ğŸ¯ é—®é¢˜è§£å†³

### åŸå§‹é—®é¢˜
- **å‚ç›´æ»‘åŠ¨å¹²æ‰°**ï¼šç”¨æˆ·æ‹–æ‹½æ»‘å—æ—¶ï¼Œå¦‚æœæ‰‹æŒ‡ç¨å¾®å‘ä¸‹ç§»åŠ¨ï¼Œä¼šè§¦å‘ScrollViewçš„æ»šåŠ¨
- **æ»‘å—å¤±æ•ˆ**ï¼šä¸€æ—¦è§¦å‘å‚ç›´æ»šåŠ¨ï¼Œæ»‘å—å°±ä¼šå¤±å»å“åº”
- **ç”¨æˆ·ä½“éªŒå·®**ï¼šéœ€è¦éå¸¸ç²¾ç¡®çš„æ°´å¹³æ»‘åŠ¨æ‰èƒ½æ­£å¸¸ä½¿ç”¨

### è§£å†³æ–¹æ¡ˆ
- **æ–¹å‘è¯†åˆ«**ï¼šåªæœ‰å½“æ°´å¹³ç§»åŠ¨è·ç¦»å¤§äºå‚ç›´ç§»åŠ¨è·ç¦»æ—¶æ‰å“åº”æ»‘å—
- **æ°´å¹³é”å®š**ï¼šä¸€æ—¦å¼€å§‹æ»‘å—æ“ä½œï¼Œåªå¤„ç†æ°´å¹³æ–¹å‘çš„ç§»åŠ¨
- **æ‰‹åŠ¿ä¼˜å…ˆçº§**ï¼šæ»‘å—æ‰‹åŠ¿ä¼˜å…ˆäºScrollViewæ»šåŠ¨

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ™ºèƒ½æ‰‹åŠ¿è¯†åˆ«
```typescript
onMoveShouldSetPanResponder: (evt, gestureState) => {
  if (isLoading) return false;
  
  // åªæœ‰å½“æ°´å¹³ç§»åŠ¨è·ç¦»å¤§äºå‚ç›´ç§»åŠ¨è·ç¦»æ—¶æ‰å“åº”
  const absX = Math.abs(gestureState.dx);
  const absY = Math.abs(gestureState.dy);
  
  return absX > absY && absX > 5; // æ°´å¹³ç§»åŠ¨è¶…è¿‡5åƒç´ ä¸”å¤§äºå‚ç›´ç§»åŠ¨æ—¶æ‰å“åº”
},
```

**å…³é”®é€»è¾‘ï¼š**
- `absX > absY`ï¼šæ°´å¹³ç§»åŠ¨è·ç¦»å¿…é¡»å¤§äºå‚ç›´ç§»åŠ¨è·ç¦»
- `absX > 5`ï¼šæ°´å¹³ç§»åŠ¨å¿…é¡»è¶…è¿‡5åƒç´ çš„é˜ˆå€¼
- è¿™æ ·å¯ä»¥æœ‰æ•ˆåŒºåˆ†ç”¨æˆ·æ˜¯æƒ³æ»‘åŠ¨æ»‘å—è¿˜æ˜¯æ»šåŠ¨é¡µé¢

### 2. åŸºå‡†å€¼è®°å½•
```typescript
const [dragStartValue, setDragStartValue] = useState<number>(0);

onPanResponderGrant: (evt) => {
  // å¼€å§‹æ‹–æ‹½æ—¶è®°å½•å½“å‰å€¼ä½œä¸ºåŸºå‡†
  setDragStartValue(contextSliderValue);
  return true;
},
```

**ä¼˜åŠ¿ï¼š**
- é¿å…äº†ç´¯ç§¯è¯¯å·®
- ç¡®ä¿æ‹–æ‹½çš„åŸºå‡†ä½ç½®å§‹ç»ˆæ­£ç¡®
- é˜²æ­¢æ»‘å—ä½ç½®è·³è·ƒ

### 3. çº¯æ°´å¹³ç§»åŠ¨å¤„ç†
```typescript
onPanResponderMove: (evt, gestureState) => {
  if (isLoading) return;
  
  // åªå¤„ç†æ°´å¹³æ–¹å‘çš„ç§»åŠ¨ï¼Œå¿½ç•¥å‚ç›´æ–¹å‘
  const horizontalMovement = gestureState.dx;
  
  // ä½¿ç”¨æ‹–æ‹½å¼€å§‹æ—¶çš„å€¼ä½œä¸ºåŸºå‡†ä½ç½®
  const basePosition = ((dragStartValue - 1) / (MAX_CONTEXT_VALUE - 1)) * (sliderWidth - thumbSize);
  
  // è®¡ç®—æ–°çš„æ»‘å—ä½ç½®ï¼ˆåªåŠ ä¸Šæ°´å¹³åç§»ï¼‰
  const newPosition = Math.max(0, Math.min(sliderWidth - thumbSize, basePosition + horizontalMovement));
  
  // è½¬æ¢ä¸ºæ»‘å—å€¼
  const newValue = 1 + (newPosition / (sliderWidth - thumbSize)) * (MAX_CONTEXT_VALUE - 1);
  
  // æ›´æ–°çŠ¶æ€
  setContextSliderValue(Math.round(newValue));
},
```

**ç‰¹ç‚¹ï¼š**
- åªä½¿ç”¨`gestureState.dx`ï¼ˆæ°´å¹³åç§»ï¼‰
- å®Œå…¨å¿½ç•¥`gestureState.dy`ï¼ˆå‚ç›´åç§»ï¼‰
- åŸºäºæ‹–æ‹½å¼€å§‹æ—¶çš„å€¼è®¡ç®—æ–°ä½ç½®

### 4. æ‰‹åŠ¿ä¼˜å…ˆçº§æ§åˆ¶
```typescript
onPanResponderTerminationRequest: () => false, // ä¸å…è®¸å…¶ä»–ç»„ä»¶ç»ˆæ­¢è¿™ä¸ªæ‰‹åŠ¿
onShouldBlockNativeResponder: () => true, // é˜»æ­¢åŸç”Ÿç»„ä»¶å“åº”
```

**ä½œç”¨ï¼š**
- ç¡®ä¿æ»‘å—æ‰‹åŠ¿ä¸ä¼šè¢«å…¶ä»–ç»„ä»¶ä¸­æ–­
- é˜²æ­¢ScrollViewæŠ¢å¤ºæ‰‹åŠ¿æ§åˆ¶æƒ

### 5. æ‰©å¤§è§¦æ‘¸åŒºåŸŸ
```typescript
// æ»‘å—å®¹å™¨ - 40x40pxçš„è§¦æ‘¸åŒºåŸŸ
sliderThumbContainer: {
  position: 'absolute',
  top: 0,
  width: 40,
  height: 40,
  justifyContent: 'center',
  alignItems: 'center',
},

// å®é™…æ»‘å— - 20x20pxçš„è§†è§‰å…ƒç´ 
sliderThumb: {
  width: 20,
  height: 20,
  backgroundColor: '#007AFF',
  borderRadius: 10,
  // ... å…¶ä»–æ ·å¼
},
```

**ä¼˜åŠ¿ï¼š**
- æ›´å¤§çš„è§¦æ‘¸åŒºåŸŸï¼ˆ40x40pxï¼‰
- æ›´å®¹æ˜“æŠ“å–æ»‘å—
- å‡å°‘è¯¯æ“ä½œ

## ğŸ¯ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### æ“ä½œå®¹é”™æ€§
- **æ–œå‘æ‹–æ‹½**ï¼šç”¨æˆ·å¯ä»¥ç¨å¾®æ–œå‘æ‹–æ‹½ï¼Œç³»ç»Ÿåªå“åº”æ°´å¹³åˆ†é‡
- **å‚ç›´å®¹å¿**ï¼šå°å¹…åº¦çš„å‚ç›´ç§»åŠ¨ä¸ä¼šå½±å“æ»‘å—æ“ä½œ
- **è‡ªç„¶æ‰‹åŠ¿**ï¼šç¬¦åˆç”¨æˆ·çš„è‡ªç„¶æ‹–æ‹½ä¹ æƒ¯

### å“åº”ä¼˜å…ˆçº§
```
ç”¨æˆ·æ‰‹åŠ¿åˆ¤æ–­æµç¨‹ï¼š
1. æ£€æµ‹åˆ°æ‰‹åŠ¿å¼€å§‹
2. è®¡ç®—æ°´å¹³å’Œå‚ç›´ç§»åŠ¨è·ç¦»
3. å¦‚æœæ°´å¹³ > å‚ç›´ ä¸” æ°´å¹³ > 5px â†’ æ»‘å—å“åº”
4. å¦åˆ™ â†’ ScrollViewå“åº”
```

### è§†è§‰åé¦ˆ
- **å³æ—¶å“åº”**ï¼šæ‰‹åŠ¿è¯†åˆ«åç«‹å³å¼€å§‹æ»‘å—ç§»åŠ¨
- **æµç•…åŠ¨ç”»**ï¼šåªæœ‰æ°´å¹³ç§»åŠ¨ï¼Œé¿å…æŠ–åŠ¨
- **ç²¾ç¡®å®šä½**ï¼šåŸºäºå‡†ç¡®çš„åŸºå‡†å€¼è®¡ç®—

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### è®¡ç®—æ•ˆç‡
- **å‡å°‘é‡å¤è®¡ç®—**ï¼šåŸºå‡†å€¼åªåœ¨å¼€å§‹æ—¶è®¡ç®—ä¸€æ¬¡
- **ç®€åŒ–å…¬å¼**ï¼šåªå¤„ç†æ°´å¹³æ–¹å‘ï¼Œå‡å°‘è®¡ç®—é‡
- **è¾¹ç•Œæ£€æŸ¥**ï¼šMath.max/Math.minç¡®ä¿å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…

### å†…å­˜ç®¡ç†
- **çŠ¶æ€æœ€å°åŒ–**ï¼šåªæ·»åŠ å¿…è¦çš„dragStartValueçŠ¶æ€
- **åŠæ—¶æ¸…ç†**ï¼šPanResponderè‡ªåŠ¨ç®¡ç†äº‹ä»¶ç›‘å¬
- **é¿å…å†…å­˜æ³„æ¼**ï¼šç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨æ¸…ç†

## ğŸš€ å®é™…æ•ˆæœ

### ä½¿ç”¨åœºæ™¯æµ‹è¯•
1. **çº¯æ°´å¹³æ‹–æ‹½**ï¼šâœ… å®Œç¾å“åº”
2. **ç¨å¾®æ–œå‘æ‹–æ‹½**ï¼šâœ… åªå“åº”æ°´å¹³åˆ†é‡
3. **å‚ç›´æ»šåŠ¨é¡µé¢**ï¼šâœ… ä¸ä¼šè¯¯è§¦æ»‘å—
4. **å¿«é€Ÿæ‹–æ‹½**ï¼šâœ… è·Ÿéšæµç•…
5. **è¾¹ç•Œå¤„ç†**ï¼šâœ… è‡ªåŠ¨é™åˆ¶åœ¨æœ‰æ•ˆèŒƒå›´

### å…¼å®¹æ€§
- **iOS**ï¼šå®Œç¾æ”¯æŒ
- **Android**ï¼šå®Œç¾æ”¯æŒ
- **ä¸åŒå±å¹•å°ºå¯¸**ï¼šè‡ªé€‚åº”
- **ä¸åŒæ‰‹æŒ‡å¤§å°**ï¼š40pxè§¦æ‘¸åŒºåŸŸé€‚åˆæ‰€æœ‰ç”¨æˆ·

## ğŸ” è°ƒè¯•ä¿¡æ¯

### æ‰‹åŠ¿è¯†åˆ«æ—¥å¿—
```typescript
// å¯ä»¥æ·»åŠ è°ƒè¯•æ—¥å¿—
onMoveShouldSetPanResponder: (evt, gestureState) => {
  const absX = Math.abs(gestureState.dx);
  const absY = Math.abs(gestureState.dy);
  
  console.log(`Gesture: dx=${gestureState.dx}, dy=${gestureState.dy}, absX=${absX}, absY=${absY}`);
  
  return absX > absY && absX > 5;
},
```

### æ»‘å—ä½ç½®æ—¥å¿—
```typescript
onPanResponderMove: (evt, gestureState) => {
  const newValue = /* è®¡ç®—é€»è¾‘ */;
  
  console.log(`Slider: startValue=${dragStartValue}, dx=${gestureState.dx}, newValue=${newValue}`);
  
  setContextSliderValue(Math.round(newValue));
},
```

è¿™ä¸ªä¼˜åŒ–å®Œå…¨è§£å†³äº†æ»‘å—ä¸ScrollViewçš„å†²çªé—®é¢˜ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥è‡ªç„¶åœ°æ‹–æ‹½æ»‘å—ï¼Œä¸ç”¨æ‹…å¿ƒè§¦å‘é¡µé¢æ»šåŠ¨ï¼ğŸŠ
